# yocto 사용해보기

What is?
리눅스 배포 자동화 도구

설치 패키지

python3
python3-distutils
xterm net-tools
chrpath diffstat g++ gawk groff
libncurses-dev
make gcc
vim tree git

`$ git clone -b dunfell git://git.yoctoproject.org/poky.git`


임베디드 리눅스 배포
CD(DVD)
-> distro for Acme board
-> distribute
-> install on Acme board

Yocto 구성요소
1. open embedded(oe_)
2. bitbake
    - 빌드 엔진
    - recipe
        - .bb
        - .bbappend
        - .bbclass
        - .conf
    -> 레시피 코드를 읽어들여 실행 작업(=task)(fetch, unpack, patch, configure, compile, link, insatll, pakage)
3. poky(basic distro)

관련 용어
- Append file
- Bitbake
- BSP
- Class
- Conf file
- Cress tool chain
- Image
- Layer
- Meta data
- OE(oe-core)(meta folder)
- Package
- Package Management System
- Poky
- Recipe
- Task
- Upstream

오픈 소스 소프트웨어 빌드 절차 : Work-Flow

1. fetch( = download) : from Upstream
    'do_fetch'
    실패 시 Source Mirror 확인
2. Extract(unpack)
3. Patch
    `/poky/meta` `meta-poky` `meta-yocto-bsp`
4. Configure
5. Build
6. Install
7. Package



사용법
`~/poky/build/downloads` --> 페치한 압축 파일들
`~/poky/build/tmp`       --> 작업 디렉토리

`bitbake` : `bblayers.conf`  `local.conf`
`.bb`
`.bbappend`
`.bbclass`

메타 데이터 파일
`/poky/meta` `meta-poky` `meta-yocto-bsp` --> recipe가 들어있는 Layer file : meta data


`$ . oe-init-build-env`
`$ bitbake core-image-minimal` : 생성

`echo $BBPATH`


### 레이어 만들기
`/poky/build$ bitbake-layers create-layer {meta-xxx}` : 레이어 생성
`/poky/build$ bitbake-layers add-layer {meta-xxx}` : 레이어 추가

`meta-xxx/recipes-example/example/`로 가면 예시 파일을 볼 수 있다

```c
python do_display_banner(){
    bb.plain("************");
}
// 함수로 만들어진 작업 단위를 태스크라고 칭하며 do_{태스크 이름} 의 형태로 작성한다

addtask display_banner before do_build
// 태스크 추가 명령어
```


### bitbake 사용법
- `-h` : help
- `-b` : Out of dependencies
- `-k` : build fas possible
- `-c listtasks {core-image-minimal}` : task list up
- `-f` : force. Invalidation stamp
- `-C` : Invalidation stamp
- `-e` : environment list

> 실습 040200
### bitbake 메타데이터 문법
`#` : 주석


### 레시피를 사용하여 응용프로그램 다운로드
https://mirror.twds.com.tw/gnu/hello/